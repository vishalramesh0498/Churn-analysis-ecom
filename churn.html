<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>0783b4cb76b941efaa4e3b538e076164</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div id="738159df-0291-4a31-bbb3-c805015d6b3d" class="cell markdown">
<h1 id="marketing-analytics---churn-analysis">MARKETING ANALYTICS -
CHURN ANALYSIS</h1>
</div>
<div id="c3299f6b-7b4e-47ae-9528-f503a1fc394d" class="cell markdown">
<h3 id="importing-necessary-libraraies">Importing Necessary
Libraraies</h3>
</div>
<div id="0f1df1a1-aedb-4ca6-9c90-454f319c0de1" class="cell code"
data-execution_count="1">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Handling</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>sns.<span class="bu">set</span>()</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Data Imputing</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.impute <span class="im">import</span> KNNImputer</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Modelling</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LogisticRegression</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.tree <span class="im">import</span> DecisionTreeClassifier</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.ensemble <span class="im">import</span> RandomForestClassifier</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>warnings.filterwarnings(<span class="st">&quot;ignore&quot;</span>)</span></code></pre></div>
</div>
<div id="e804048b-5eff-4142-88f9-7f037a82015a" class="cell code"
data-execution_count="2">
<div class="sourceCode" id="cb2"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ecom <span class="op">=</span> pd.read_csv(<span class="st">&quot;data/E-Commerce Churn Data.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="c99f8658-0b2d-4fef-b023-e29e2a157526" class="cell code"
data-execution_count="3">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> ecom.copy()</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ecom.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="3">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerID</th>
      <th>Churn</th>
      <th>Tenure</th>
      <th>PreferredLoginDevice</th>
      <th>CityTier</th>
      <th>WarehouseToHome</th>
      <th>PreferredPaymentMode</th>
      <th>Gender</th>
      <th>HourSpendOnApp</th>
      <th>NumberOfDeviceRegistered</th>
      <th>PreferedOrderCat</th>
      <th>SatisfactionScore</th>
      <th>MaritalStatus</th>
      <th>NumberOfAddress</th>
      <th>Complain</th>
      <th>OrderAmountHikeFromlastYear</th>
      <th>CouponUsed</th>
      <th>OrderCount</th>
      <th>DaySinceLastOrder</th>
      <th>CashbackAmount</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>50001</td>
      <td>1</td>
      <td>4.0</td>
      <td>Mobile Phone</td>
      <td>3</td>
      <td>6.0</td>
      <td>Debit Card</td>
      <td>Female</td>
      <td>3.0</td>
      <td>3</td>
      <td>Laptop &amp; Accessory</td>
      <td>2</td>
      <td>Single</td>
      <td>9</td>
      <td>1</td>
      <td>11.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>5.0</td>
      <td>160</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50002</td>
      <td>1</td>
      <td>NaN</td>
      <td>Phone</td>
      <td>1</td>
      <td>8.0</td>
      <td>UPI</td>
      <td>Male</td>
      <td>3.0</td>
      <td>4</td>
      <td>Mobile</td>
      <td>3</td>
      <td>Single</td>
      <td>7</td>
      <td>1</td>
      <td>15.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>121</td>
    </tr>
    <tr>
      <th>2</th>
      <td>50003</td>
      <td>1</td>
      <td>NaN</td>
      <td>Phone</td>
      <td>1</td>
      <td>30.0</td>
      <td>Debit Card</td>
      <td>Male</td>
      <td>2.0</td>
      <td>4</td>
      <td>Mobile</td>
      <td>3</td>
      <td>Single</td>
      <td>6</td>
      <td>1</td>
      <td>14.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>120</td>
    </tr>
    <tr>
      <th>3</th>
      <td>50004</td>
      <td>1</td>
      <td>0.0</td>
      <td>Phone</td>
      <td>3</td>
      <td>15.0</td>
      <td>Debit Card</td>
      <td>Male</td>
      <td>2.0</td>
      <td>4</td>
      <td>Laptop &amp; Accessory</td>
      <td>5</td>
      <td>Single</td>
      <td>8</td>
      <td>0</td>
      <td>23.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>134</td>
    </tr>
    <tr>
      <th>4</th>
      <td>50005</td>
      <td>1</td>
      <td>0.0</td>
      <td>Phone</td>
      <td>1</td>
      <td>12.0</td>
      <td>CC</td>
      <td>Male</td>
      <td>NaN</td>
      <td>3</td>
      <td>Mobile</td>
      <td>5</td>
      <td>Single</td>
      <td>3</td>
      <td>0</td>
      <td>11.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>130</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="f8b8b773-adf9-484b-a050-b4fb758700c7" class="cell code"
data-execution_count="4">
<div class="sourceCode" id="cb4"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ecom.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 5630 entries, 0 to 5629
Data columns (total 20 columns):
 #   Column                       Non-Null Count  Dtype  
---  ------                       --------------  -----  
 0   CustomerID                   5630 non-null   int64  
 1   Churn                        5630 non-null   int64  
 2   Tenure                       5366 non-null   float64
 3   PreferredLoginDevice         5630 non-null   object 
 4   CityTier                     5630 non-null   int64  
 5   WarehouseToHome              5379 non-null   float64
 6   PreferredPaymentMode         5630 non-null   object 
 7   Gender                       5630 non-null   object 
 8   HourSpendOnApp               5375 non-null   float64
 9   NumberOfDeviceRegistered     5630 non-null   int64  
 10  PreferedOrderCat             5630 non-null   object 
 11  SatisfactionScore            5630 non-null   int64  
 12  MaritalStatus                5630 non-null   object 
 13  NumberOfAddress              5630 non-null   int64  
 14  Complain                     5630 non-null   int64  
 15  OrderAmountHikeFromlastYear  5365 non-null   float64
 16  CouponUsed                   5374 non-null   float64
 17  OrderCount                   5372 non-null   float64
 18  DaySinceLastOrder            5323 non-null   float64
 19  CashbackAmount               5630 non-null   int64  
dtypes: float64(7), int64(8), object(5)
memory usage: 879.8+ KB
</code></pre>
</div>
</div>
<div id="3085e8e9-ba93-41d9-bcec-2231293a1cc0" class="cell code"
data-execution_count="5">
<div class="sourceCode" id="cb6"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Percentage of Missing Values</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="bu">round</span>(ecom.isnull().<span class="bu">sum</span>()<span class="op">/</span>ecom.shape[<span class="dv">0</span>] <span class="op">*</span> <span class="dv">100</span>, <span class="dv">2</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="5">
<pre><code>CustomerID                     0.00
Churn                          0.00
Tenure                         4.69
PreferredLoginDevice           0.00
CityTier                       0.00
WarehouseToHome                4.46
PreferredPaymentMode           0.00
Gender                         0.00
HourSpendOnApp                 4.53
NumberOfDeviceRegistered       0.00
PreferedOrderCat               0.00
SatisfactionScore              0.00
MaritalStatus                  0.00
NumberOfAddress                0.00
Complain                       0.00
OrderAmountHikeFromlastYear    4.71
CouponUsed                     4.55
OrderCount                     4.58
DaySinceLastOrder              5.45
CashbackAmount                 0.00
dtype: float64</code></pre>
</div>
</div>
<div id="c821502f-2eb6-461e-8cf9-e7e7dd1d95b7" class="cell markdown">
<h3 id="data-cleaning">Data Cleaning</h3>
</div>
<div id="8748faac-8e96-4748-b6e5-76e5fced1263" class="cell markdown">
<h4 id="categorical--removing-duplicates">Categorical : Removing
Duplicates</h4>
</div>
<div id="c19f16c4-febc-46c1-8b4a-c30e67315943" class="cell code"
data-execution_count="6">
<div class="sourceCode" id="cb8"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>cat_cols <span class="op">=</span> ecom.dtypes[ecom.dtypes <span class="op">==</span> <span class="st">&#39;object&#39;</span>].index</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> cat_cols:</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss"> ---&gt; </span><span class="sc">{</span>ecom[i]<span class="sc">.</span>unique()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>PreferredLoginDevice ---&gt; [&#39;Mobile Phone&#39; &#39;Phone&#39; &#39;Computer&#39;]

PreferredPaymentMode ---&gt; [&#39;Debit Card&#39; &#39;UPI&#39; &#39;CC&#39; &#39;Cash on Delivery&#39; &#39;E wallet&#39; &#39;COD&#39; &#39;Credit Card&#39;]

Gender ---&gt; [&#39;Female&#39; &#39;Male&#39;]

PreferedOrderCat ---&gt; [&#39;Laptop &amp; Accessory&#39; &#39;Mobile&#39; &#39;Mobile Phone&#39; &#39;Others&#39; &#39;Fashion&#39; &#39;Grocery&#39;]

MaritalStatus ---&gt; [&#39;Single&#39; &#39;Divorced&#39; &#39;Married&#39;]

</code></pre>
</div>
</div>
<div id="59ca5c86-a04b-4ecc-9d95-f59eefe4902d" class="cell code"
data-execution_count="7">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Change values to lower and replace space with _ for cleaning</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> cat_cols:</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    ecom[i] <span class="op">=</span> ecom[i].<span class="bu">apply</span>(<span class="kw">lambda</span> x: x.lower().replace(<span class="st">&quot; &quot;</span>, <span class="st">&quot;_&quot;</span>))</span></code></pre></div>
</div>
<div id="b13c0333-83a6-4e97-b1a2-e4844bb11176" class="cell code"
data-execution_count="8">
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replacing duplicate values</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>ecom[<span class="st">&quot;PreferredLoginDevice&quot;</span>].replace(<span class="st">&quot;phone&quot;</span>, <span class="st">&quot;mobile_phone&quot;</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>ecom[<span class="st">&quot;PreferredPaymentMode&quot;</span>].replace([<span class="st">&quot;cc&quot;</span>, <span class="st">&quot;cod&quot;</span>], [<span class="st">&quot;credit_card&quot;</span>, <span class="st">&quot;cash_on_delivery&quot;</span>], inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>ecom[<span class="st">&quot;PreferedOrderCat&quot;</span>].replace(<span class="st">&quot;mobile_phone&quot;</span>, <span class="st">&quot;mobile&quot;</span>, inplace <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div>
</div>
<div id="2429199d-8123-4b86-a05a-228979ed7262" class="cell code"
data-execution_count="9">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking if all values are replaced</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> cat_cols:</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&quot;</span><span class="sc">{</span>i<span class="sc">}</span><span class="ss"> ---&gt; </span><span class="sc">{</span>ecom[i]<span class="sc">.</span>unique()<span class="sc">}</span><span class="ss">&quot;</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>PreferredLoginDevice ---&gt; [&#39;mobile_phone&#39; &#39;computer&#39;]

PreferredPaymentMode ---&gt; [&#39;debit_card&#39; &#39;upi&#39; &#39;credit_card&#39; &#39;cash_on_delivery&#39; &#39;e_wallet&#39;]

Gender ---&gt; [&#39;female&#39; &#39;male&#39;]

PreferedOrderCat ---&gt; [&#39;laptop_&amp;_accessory&#39; &#39;mobile&#39; &#39;others&#39; &#39;fashion&#39; &#39;grocery&#39;]

MaritalStatus ---&gt; [&#39;single&#39; &#39;divorced&#39; &#39;married&#39;]

</code></pre>
</div>
</div>
<div id="16fbf0eb-a2ac-4d70-8cbc-ba78994b8682" class="cell markdown">
<h4 id="numerical--imputing-missing-values-using-knn-imputer">Numerical
: Imputing missing values using KNN Imputer</h4>
</div>
<div id="62bc1127-1141-4d56-918b-373545033426" class="cell code"
data-execution_count="10">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Encoding before imputing missing values</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>ecom_encoded <span class="op">=</span> pd.get_dummies(ecom, drop_first <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div>
</div>
<div id="a97cdfe1-64ee-4750-90a5-ffa5ab5250c9" class="cell code"
data-execution_count="11">
<div class="sourceCode" id="cb15"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Using KNN Imputer</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>impute <span class="op">=</span> KNNImputer(n_neighbors <span class="op">=</span> <span class="dv">5</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>ecom_imputed <span class="op">=</span> impute.fit_transform(ecom_encoded)</span></code></pre></div>
</div>
<div id="683de8fe-8bb5-49c2-9b08-5e79723a3507" class="cell code"
data-execution_count="12">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Converting the imputed array to dataframe</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>ecom_imputed <span class="op">=</span> pd.DataFrame(ecom_imputed, columns <span class="op">=</span> ecom_encoded.columns)</span></code></pre></div>
</div>
<div id="f2f89de8-a54c-4079-add6-392c56e6fe69" class="cell code"
data-execution_count="13">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Replacing the old columns with imputed values for analysis</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>missing_cols <span class="op">=</span> ecom.isnull().<span class="bu">sum</span>()[ecom.isnull().<span class="bu">sum</span>() <span class="op">&gt;</span> <span class="dv">0</span>].index</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> missing_cols:</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    ecom[i] <span class="op">=</span> ecom_imputed[i]</span></code></pre></div>
</div>
<div id="71aa9bc9-bf8d-49fb-9108-097ee6d89fff" class="cell markdown">
<h3 id="eda">EDA</h3>
</div>
<div id="188f7a0c-9cec-4fe9-86cc-ecb38372c8fa" class="cell markdown">
<p><strong>Percentage of Customers who Left</strong></p>
</div>
<div id="cb53d814-293d-4e1c-862d-e811dd25162f" class="cell code"
data-execution_count="14">
<div class="sourceCode" id="cb18"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(nrows <span class="op">=</span> <span class="dv">1</span>, ncols <span class="op">=</span> <span class="dv">1</span>, figsize <span class="op">=</span> [<span class="dv">15</span>,<span class="dv">6</span>])</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>percent_count <span class="op">=</span> ecom[<span class="st">&#39;Churn&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>ax.pie(x <span class="op">=</span> ecom[<span class="st">&#39;Churn&#39;</span>].value_counts(),labels <span class="op">=</span> [<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>], autopct <span class="op">=</span> <span class="kw">lambda</span> percent_count: <span class="st">&#39;</span><span class="sc">{:.2f}</span><span class="st">%&#39;</span>.<span class="bu">format</span>(percent_count))</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>ax.set_title(<span class="st">&#39;Percentage of Customers who Left&#39;</span>, fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>ax.legend()</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_baed5312ae0c402f83c657da0b4c49fd/050d465c277cd2040b376b77a2adc68c75ab1e7f.png" /></p>
</div>
</div>
<div id="f4bcb66c-e4ac-452f-b06a-0835dfee13dd" class="cell markdown">
<ul>
<li>16% of customers left the company.</li>
</ul>
</div>
<div id="8ea715d5-b84b-4287-a170-76505c39903d" class="cell markdown">
<p><strong>Customer Churn by Gender</strong></p>
</div>
<div id="ffcfda73-f525-4421-a71b-7077e5526d0e" class="cell code"
data-execution_count="15">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fig, (ax1, ax2) <span class="op">=</span> plt.subplots(nrows <span class="op">=</span> <span class="dv">1</span>, ncols <span class="op">=</span> <span class="dv">2</span>, figsize <span class="op">=</span> [<span class="dv">15</span>,<span class="dv">6</span>])</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>percent_count <span class="op">=</span> ecom[ecom[<span class="st">&quot;Gender&quot;</span>] <span class="op">==</span> <span class="st">&quot;male&quot;</span>][<span class="st">&#39;Churn&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>ax1.pie(x <span class="op">=</span> ecom[ecom[<span class="st">&quot;Gender&quot;</span>] <span class="op">==</span> <span class="st">&quot;male&quot;</span>][<span class="st">&#39;Churn&#39;</span>].value_counts(),labels <span class="op">=</span> [<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>], autopct <span class="op">=</span> <span class="kw">lambda</span> percent_count: <span class="st">&#39;</span><span class="sc">{:.2f}</span><span class="st">%&#39;</span>.<span class="bu">format</span>(percent_count))</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>ax1.set_title(<span class="st">&#39;Percentage of Male Customers who Left&#39;</span>, fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>ax1.legend()</span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>percent_count <span class="op">=</span> ecom[ecom[<span class="st">&quot;Gender&quot;</span>] <span class="op">==</span> <span class="st">&quot;female&quot;</span>][<span class="st">&#39;Churn&#39;</span>].value_counts(normalize <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>ax2.pie(x <span class="op">=</span> ecom[ecom[<span class="st">&quot;Gender&quot;</span>] <span class="op">==</span> <span class="st">&quot;female&quot;</span>][<span class="st">&#39;Churn&#39;</span>].value_counts(),labels <span class="op">=</span> [<span class="st">&quot;No&quot;</span>, <span class="st">&quot;Yes&quot;</span>], autopct <span class="op">=</span> <span class="kw">lambda</span> percent_count: <span class="st">&#39;</span><span class="sc">{:.2f}</span><span class="st">%&#39;</span>.<span class="bu">format</span>(percent_count))</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>ax2.set_title(<span class="st">&#39;Percentage of Female Customers who Left&#39;</span>, fontsize <span class="op">=</span> <span class="dv">12</span>)</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>ax2.legend()</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_baed5312ae0c402f83c657da0b4c49fd/b3bec749aeb2b92a11e692b49bea000361c5a19b.png" /></p>
</div>
</div>
<div id="8eb4073c-63f5-4391-a219-3dd7db367808" class="cell markdown">
<ul>
<li>Gender has no effect on churn since the percentage of males and
females who left the company is almost same.</li>
</ul>
</div>
<div id="28f5c4a4-b4ea-4ed7-a8b5-f1031c96f4ef" class="cell markdown">
<p><strong>Customer Churn by Tenure Range</strong></p>
</div>
<div id="c7235e8f-961f-476d-bae8-caf43e972de2" class="cell code"
data-execution_count="16">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating Tenure Groups</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">18</span>, <span class="dv">30</span>, np.inf]</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> [<span class="st">&#39;0-18&#39;</span>, <span class="st">&#39;18-30&#39;</span>, <span class="st">&#39;30+&#39;</span>]</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>ecom[<span class="st">&#39;TenureRange&#39;</span>] <span class="op">=</span> pd.cut(ecom[<span class="st">&#39;Tenure&#39;</span>], bins <span class="op">=</span> bins, labels <span class="op">=</span> labels, right <span class="op">=</span> <span class="va">False</span>, include_lowest <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">6</span>))</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> sns.countplot(data <span class="op">=</span> ecom, x <span class="op">=</span> <span class="st">&#39;TenureRange&#39;</span>, hue <span class="op">=</span> <span class="st">&#39;Churn&#39;</span>, palette <span class="op">=</span> <span class="st">&#39;Set1&#39;</span>)</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> p <span class="kw">in</span> ax.patches:</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    height <span class="op">=</span> p.get_height()</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> height <span class="op">&gt;</span> <span class="dv">0</span>:</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>        ax.annotate(<span class="ss">f&#39;</span><span class="sc">{</span><span class="bu">int</span>(height)<span class="sc">}</span><span class="ss">&#39;</span>, </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>                    (p.get_x() <span class="op">+</span> p.get_width() <span class="op">/</span> <span class="fl">2.</span>, height), </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>                    ha <span class="op">=</span> <span class="st">&#39;center&#39;</span>, va <span class="op">=</span> <span class="st">&#39;baseline&#39;</span>, </span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>                    xytext <span class="op">=</span> (<span class="dv">0</span>, <span class="dv">3</span>), weight <span class="op">=</span> <span class="st">&#39;bold&#39;</span>,</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>                    textcoords <span class="op">=</span> <span class="st">&#39;offset points&#39;</span>)</span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Customer Churn by Tenure Range&#39;</span>)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Tenure Bins&#39;</span>)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Frequency&#39;</span>)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_baed5312ae0c402f83c657da0b4c49fd/87b6b1aa60780a67b6001176480b53d296b01b0b.png" /></p>
</div>
</div>
<div id="ab066fb1-8f0f-41bf-949f-0fc76b69b865" class="cell markdown">
<ul>
<li>Most customers churned in the first 18 months may be due to the
first impressions from the company.</li>
<li>Long term customers tend to stay longer may be due to the service
provided by the company.</li>
<li>This indicates that the company should focus on giving more priority
to new customers.</li>
</ul>
</div>
<div id="9dce2d2d-afb4-4a5b-b666-97d053f16552" class="cell markdown">
<p><strong>Average Estimated Monthly Spending by Tenure</strong></p>
</div>
<div id="a4f29a6c-8b68-49c7-867c-0e2b412ec5fc" class="cell code"
data-execution_count="17">
<div class="sourceCode" id="cb21"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>ecom[<span class="st">&#39;EstimatedMonthlySpending&#39;</span>] <span class="op">=</span> ecom[<span class="st">&#39;OrderCount&#39;</span>] <span class="op">*</span> ecom[<span class="st">&#39;OrderAmountHikeFromlastYear&#39;</span>]</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>tenure_spending_avg <span class="op">=</span> ecom.groupby(<span class="st">&#39;Tenure&#39;</span>)[<span class="st">&#39;EstimatedMonthlySpending&#39;</span>].mean().reset_index()</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">6</span>))</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>sns.lineplot(data <span class="op">=</span> tenure_spending_avg, x <span class="op">=</span> <span class="st">&#39;Tenure&#39;</span>, y <span class="op">=</span> <span class="st">&#39;EstimatedMonthlySpending&#39;</span>, marker <span class="op">=</span> <span class="st">&#39;o&#39;</span>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Average Estimated Monthly Spending by Tenure&#39;</span>)</span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Tenure (Months)&#39;</span>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Average Estimated Monthly Spending&#39;</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_baed5312ae0c402f83c657da0b4c49fd/911f2bebfe84f32e06e5eca3187210259e983f47.png" /></p>
</div>
</div>
<div id="ebd435f3-4aa7-4b9a-bb39-1be48a1adca6" class="cell markdown">
<ul>
<li>The graph shows that the estimated monthly spending doesn't have any
impact on tenure.</li>
</ul>
</div>
<div id="8dbafb40-df29-4534-bc1a-cc8479f9fe64" class="cell markdown">
<p><strong>Churn by Satisfaction Score</strong></p>
</div>
<div id="157774b1-86ed-4573-bb3b-c2bb51640081" class="cell code"
data-execution_count="18">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">6</span>))</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(data <span class="op">=</span> ecom, x <span class="op">=</span> <span class="st">&#39;SatisfactionScore&#39;</span>, hue <span class="op">=</span> <span class="st">&#39;Churn&#39;</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Churn by Satisfaction Score&#39;</span>)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Satisfaction Score&#39;</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Count&#39;</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>plt.legend(title <span class="op">=</span> <span class="st">&#39;Churn&#39;</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_baed5312ae0c402f83c657da0b4c49fd/ad344a6a91f02c580d27900f99ef29e91723d0f7.png" /></p>
</div>
</div>
<div id="dd8964e9-5e9c-4a59-8a5e-8b5c09edb7a0" class="cell markdown">
<ul>
<li>Satisfaction Score has no effect on Customer Churn since the
percentage of churned customers is similar by comparing bar
heights.</li>
</ul>
</div>
<div id="d79801fc-9666-4469-84ce-0f1395fd8969" class="cell markdown">
<p><strong>Order Amount Hike by City Tier and Satisfaction
Score</strong></p>
</div>
<div id="701ce08b-db49-4d93-88f2-f2cc236eafb9" class="cell code"
data-execution_count="19">
<div class="sourceCode" id="cb23"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">8</span>))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>sns.boxenplot(data<span class="op">=</span>ecom, x<span class="op">=</span><span class="st">&#39;CityTier&#39;</span>, y<span class="op">=</span><span class="st">&#39;OrderAmountHikeFromlastYear&#39;</span>, hue<span class="op">=</span><span class="st">&#39;SatisfactionScore&#39;</span>, palette<span class="op">=</span><span class="st">&#39;Blues&#39;</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Order Amount Hike by City Tier and Satisfaction Score&#39;</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;City Tier&#39;</span>)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Order Amount Hike from Last Year&#39;</span>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>plt.legend(title<span class="op">=</span><span class="st">&#39;Satisfaction Score&#39;</span>, loc <span class="op">=</span> <span class="st">&quot;upper center&quot;</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_baed5312ae0c402f83c657da0b4c49fd/671282ba0711ff64a49adeb17f8f4132bd8eed2f.png" /></p>
</div>
</div>
<div id="fcd59d12-98b2-4aac-a964-31fc21ac5848" class="cell markdown">
<ul>
<li>The order amount hike is equally distributed for all satisfaction
scores for cities 1 and 3.</li>
<li>In city tier 2 people with low satisfaction scores tend to have a
lower order amount hike compared to people with good satisfaction
scores.</li>
<li>This implies that the company could concentrate on customers in city
tier 2 by giving more offers and discounts.</li>
</ul>
</div>
<div id="56f45410-7166-4c7d-908c-ebcfff200351" class="cell markdown">
<p><strong>Pairplot of Continuous Variables by Churn Status</strong></p>
</div>
<div id="200c6989-c2bd-4dd8-8652-3db705781a15" class="cell code"
data-execution_count="20">
<div class="sourceCode" id="cb24"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>sns.pairplot(ecom, <span class="bu">vars</span><span class="op">=</span>[<span class="st">&#39;Tenure&#39;</span>, <span class="st">&#39;OrderCount&#39;</span>, <span class="st">&#39;CashbackAmount&#39;</span>, <span class="st">&#39;CouponUsed&#39;</span>,<span class="st">&#39;EstimatedMonthlySpending&#39;</span>, <span class="st">&#39;DaySinceLastOrder&#39;</span>], hue <span class="op">=</span> <span class="st">&#39;Churn&#39;</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>plt.suptitle(<span class="st">&#39;Pairplot of Continuous Variables by Churn Status&#39;</span>, y <span class="op">=</span> <span class="fl">1.02</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_baed5312ae0c402f83c657da0b4c49fd/a5cd480b358fa40d2a3f3a3cb25221a47e9cfb24.png" /></p>
</div>
</div>
<div id="effbdf1a-e825-4691-b7d5-e94974ced6de" class="cell code"
data-execution_count="21">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>ecom.corr()</span></code></pre></div>
<div class="output execute_result" data-execution_count="21">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerID</th>
      <th>Churn</th>
      <th>Tenure</th>
      <th>CityTier</th>
      <th>WarehouseToHome</th>
      <th>HourSpendOnApp</th>
      <th>NumberOfDeviceRegistered</th>
      <th>SatisfactionScore</th>
      <th>NumberOfAddress</th>
      <th>Complain</th>
      <th>OrderAmountHikeFromlastYear</th>
      <th>CouponUsed</th>
      <th>OrderCount</th>
      <th>DaySinceLastOrder</th>
      <th>CashbackAmount</th>
      <th>EstimatedMonthlySpending</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>CustomerID</th>
      <td>1.000000</td>
      <td>-0.019083</td>
      <td>0.050703</td>
      <td>0.003239</td>
      <td>0.061548</td>
      <td>0.603146</td>
      <td>0.411098</td>
      <td>-0.033146</td>
      <td>0.160814</td>
      <td>-0.009944</td>
      <td>0.123574</td>
      <td>0.236334</td>
      <td>0.137242</td>
      <td>0.118381</td>
      <td>0.217173</td>
      <td>0.156947</td>
    </tr>
    <tr>
      <th>Churn</th>
      <td>-0.019083</td>
      <td>1.000000</td>
      <td>-0.340333</td>
      <td>0.084703</td>
      <td>0.070135</td>
      <td>0.014232</td>
      <td>0.107939</td>
      <td>0.105481</td>
      <td>0.043931</td>
      <td>0.250188</td>
      <td>-0.014092</td>
      <td>-0.011395</td>
      <td>-0.036413</td>
      <td>-0.154010</td>
      <td>-0.154161</td>
      <td>-0.042793</td>
    </tr>
    <tr>
      <th>Tenure</th>
      <td>0.050703</td>
      <td>-0.340333</td>
      <td>1.000000</td>
      <td>-0.051261</td>
      <td>-0.015125</td>
      <td>0.009558</td>
      <td>-0.014516</td>
      <td>-0.013632</td>
      <td>0.240419</td>
      <td>-0.018493</td>
      <td>0.017388</td>
      <td>0.150077</td>
      <td>0.210519</td>
      <td>0.193992</td>
      <td>0.483951</td>
      <td>0.205883</td>
    </tr>
    <tr>
      <th>CityTier</th>
      <td>0.003239</td>
      <td>0.084703</td>
      <td>-0.051261</td>
      <td>1.000000</td>
      <td>0.013338</td>
      <td>-0.001496</td>
      <td>0.027934</td>
      <td>-0.011554</td>
      <td>-0.029440</td>
      <td>0.003375</td>
      <td>-0.031263</td>
      <td>0.021853</td>
      <td>0.029597</td>
      <td>0.023470</td>
      <td>0.055698</td>
      <td>0.036298</td>
    </tr>
    <tr>
      <th>WarehouseToHome</th>
      <td>0.061548</td>
      <td>0.070135</td>
      <td>-0.015125</td>
      <td>0.013338</td>
      <td>1.000000</td>
      <td>0.065658</td>
      <td>0.022410</td>
      <td>0.007994</td>
      <td>-0.008228</td>
      <td>0.027536</td>
      <td>0.040357</td>
      <td>0.002847</td>
      <td>0.011055</td>
      <td>0.018145</td>
      <td>-0.003837</td>
      <td>0.016258</td>
    </tr>
    <tr>
      <th>HourSpendOnApp</th>
      <td>0.603146</td>
      <td>0.014232</td>
      <td>0.009558</td>
      <td>-0.001496</td>
      <td>0.065658</td>
      <td>1.000000</td>
      <td>0.322235</td>
      <td>0.030820</td>
      <td>0.153634</td>
      <td>0.009824</td>
      <td>0.109748</td>
      <td>0.192609</td>
      <td>0.113523</td>
      <td>0.091777</td>
      <td>0.146472</td>
      <td>0.125718</td>
    </tr>
    <tr>
      <th>NumberOfDeviceRegistered</th>
      <td>0.411098</td>
      <td>0.107939</td>
      <td>-0.014516</td>
      <td>0.027934</td>
      <td>0.022410</td>
      <td>0.322235</td>
      <td>1.000000</td>
      <td>-0.017228</td>
      <td>0.084997</td>
      <td>0.003407</td>
      <td>0.072436</td>
      <td>0.148421</td>
      <td>0.097007</td>
      <td>0.024820</td>
      <td>0.137396</td>
      <td>0.104464</td>
    </tr>
    <tr>
      <th>SatisfactionScore</th>
      <td>-0.033146</td>
      <td>0.105481</td>
      <td>-0.013632</td>
      <td>-0.011554</td>
      <td>0.007994</td>
      <td>0.030820</td>
      <td>-0.017228</td>
      <td>1.000000</td>
      <td>0.053583</td>
      <td>-0.031115</td>
      <td>-0.030101</td>
      <td>0.015781</td>
      <td>0.019371</td>
      <td>0.025894</td>
      <td>0.003429</td>
      <td>0.011703</td>
    </tr>
    <tr>
      <th>NumberOfAddress</th>
      <td>0.160814</td>
      <td>0.043931</td>
      <td>0.240419</td>
      <td>-0.029440</td>
      <td>-0.008228</td>
      <td>0.153634</td>
      <td>0.084997</td>
      <td>0.053583</td>
      <td>1.000000</td>
      <td>-0.026399</td>
      <td>0.019608</td>
      <td>0.047904</td>
      <td>0.004748</td>
      <td>-0.057574</td>
      <td>0.186802</td>
      <td>0.004994</td>
    </tr>
    <tr>
      <th>Complain</th>
      <td>-0.009944</td>
      <td>0.250188</td>
      <td>-0.018493</td>
      <td>0.003375</td>
      <td>0.027536</td>
      <td>0.009824</td>
      <td>0.003407</td>
      <td>-0.031115</td>
      <td>-0.026399</td>
      <td>1.000000</td>
      <td>-0.004951</td>
      <td>-0.006605</td>
      <td>-0.013751</td>
      <td>-0.041405</td>
      <td>0.000598</td>
      <td>-0.010234</td>
    </tr>
    <tr>
      <th>OrderAmountHikeFromlastYear</th>
      <td>0.123574</td>
      <td>-0.014092</td>
      <td>0.017388</td>
      <td>-0.031263</td>
      <td>0.040357</td>
      <td>0.109748</td>
      <td>0.072436</td>
      <td>-0.030101</td>
      <td>0.019608</td>
      <td>-0.004951</td>
      <td>1.000000</td>
      <td>0.029155</td>
      <td>0.024657</td>
      <td>0.008923</td>
      <td>0.035011</td>
      <td>0.261863</td>
    </tr>
    <tr>
      <th>CouponUsed</th>
      <td>0.236334</td>
      <td>-0.011395</td>
      <td>0.150077</td>
      <td>0.021853</td>
      <td>0.002847</td>
      <td>0.192609</td>
      <td>0.148421</td>
      <td>0.015781</td>
      <td>0.047904</td>
      <td>-0.006605</td>
      <td>0.029155</td>
      <td>1.000000</td>
      <td>0.656541</td>
      <td>0.330156</td>
      <td>0.283323</td>
      <td>0.618187</td>
    </tr>
    <tr>
      <th>OrderCount</th>
      <td>0.137242</td>
      <td>-0.036413</td>
      <td>0.210519</td>
      <td>0.029597</td>
      <td>0.011055</td>
      <td>0.113523</td>
      <td>0.097007</td>
      <td>0.019371</td>
      <td>0.004748</td>
      <td>-0.013751</td>
      <td>0.024657</td>
      <td>0.656541</td>
      <td>1.000000</td>
      <td>0.461665</td>
      <td>0.376922</td>
      <td>0.944384</td>
    </tr>
    <tr>
      <th>DaySinceLastOrder</th>
      <td>0.118381</td>
      <td>-0.154010</td>
      <td>0.193992</td>
      <td>0.023470</td>
      <td>0.018145</td>
      <td>0.091777</td>
      <td>0.024820</td>
      <td>0.025894</td>
      <td>-0.057574</td>
      <td>-0.041405</td>
      <td>0.008923</td>
      <td>0.330156</td>
      <td>0.461665</td>
      <td>1.000000</td>
      <td>0.354452</td>
      <td>0.437296</td>
    </tr>
    <tr>
      <th>CashbackAmount</th>
      <td>0.217173</td>
      <td>-0.154161</td>
      <td>0.483951</td>
      <td>0.055698</td>
      <td>-0.003837</td>
      <td>0.146472</td>
      <td>0.137396</td>
      <td>0.003429</td>
      <td>0.186802</td>
      <td>0.000598</td>
      <td>0.035011</td>
      <td>0.283323</td>
      <td>0.376922</td>
      <td>0.354452</td>
      <td>1.000000</td>
      <td>0.359799</td>
    </tr>
    <tr>
      <th>EstimatedMonthlySpending</th>
      <td>0.156947</td>
      <td>-0.042793</td>
      <td>0.205883</td>
      <td>0.036298</td>
      <td>0.016258</td>
      <td>0.125718</td>
      <td>0.104464</td>
      <td>0.011703</td>
      <td>0.004994</td>
      <td>-0.010234</td>
      <td>0.261863</td>
      <td>0.618187</td>
      <td>0.944384</td>
      <td>0.437296</td>
      <td>0.359799</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="191b180e-0a9c-4dc8-90b6-48af3578a9d9" class="cell markdown">
<ul>
<li><code>CouponUsed</code> and <code>OrderCount</code> have a better
correlation than any other features in the original data which doesn't
provide any insights.</li>
<li>Rest all features have a very lower correlation score with other
variables.</li>
<li>The made up column <code>EstimatedMonthlySpending</code> have a
better correlation with all other variables in the dataset.</li>
</ul>
</div>
<div id="8135f854-647a-4297-9822-0ceee6f1b2d1" class="cell markdown">
<h3 id="modelling">Modelling</h3>
</div>
<div id="12a446b7-30f5-4916-a8dc-5e5bfc7e7390" class="cell markdown">
<p><strong>Preprocessing</strong></p>
</div>
<div id="0fc09634-517b-41ff-abc7-65302f45124f" class="cell code"
data-execution_count="39">
<div class="sourceCode" id="cb26"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> ecom.drop(columns <span class="op">=</span> [<span class="st">&quot;CustomerID&quot;</span>, <span class="st">&quot;Churn&quot;</span>, <span class="st">&quot;EstimatedMonthlySpending&quot;</span>, <span class="st">&quot;TenureRange&quot;</span>])</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> pd.get_dummies(x, drop_first <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> ecom[<span class="st">&quot;Churn&quot;</span>]</span></code></pre></div>
</div>
<div id="37ddfcb0-cf01-4e64-9c5c-7f18a78a36e3" class="cell code"
data-execution_count="40">
<div class="sourceCode" id="cb27"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(X, y, test_size <span class="op">=</span> <span class="fl">0.2</span>, random_state <span class="op">=</span> <span class="dv">123</span>)</span></code></pre></div>
</div>
<div id="abe2e3bb-2953-482b-aca5-023d39c44356" class="cell markdown">
<p><strong>Logistic Regression</strong></p>
</div>
<div id="5ab2cd8a-5b16-4f72-bf21-f1f1fb187b93" class="cell code"
data-execution_count="41">
<div class="sourceCode" id="cb28"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>log <span class="op">=</span> LogisticRegression(random_state <span class="op">=</span> <span class="dv">123</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>log.fit(x_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="41">
<style>#sk-container-id-4 {color: black;}#sk-container-id-4 pre{padding: 0;}#sk-container-id-4 div.sk-toggleable {background-color: white;}#sk-container-id-4 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-4 label.sk-toggleable__label-arrow:before {content: "";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-4 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-4 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-4 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-4 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-4 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-4 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "";}#sk-container-id-4 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-4 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-4 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-4 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-4 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-4 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-4 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-4 div.sk-item {position: relative;z-index: 1;}#sk-container-id-4 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-4 div.sk-item::before, #sk-container-id-4 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-4 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-4 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-4 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-4 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-4 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-4 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-4 div.sk-label-container {text-align: center;}#sk-container-id-4 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-4 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-4" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LogisticRegression(random_state=123)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-4" type="checkbox" checked><label for="sk-estimator-id-4" class="sk-toggleable__label sk-toggleable__label-arrow">LogisticRegression</label><div class="sk-toggleable__content"><pre>LogisticRegression(random_state=123)</pre></div></div></div></div></div>
</div>
</div>
<div id="2a4f1d0d-1f5f-4ba8-b355-7bcefc926564" class="cell code"
data-execution_count="42">
<div class="sourceCode" id="cb29"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>y_pred_train <span class="op">=</span> log.predict(x_train)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>y_pred_test <span class="op">=</span> log.predict(x_test)</span></code></pre></div>
</div>
<div id="1b483991-f553-4010-a035-5a05c784aa1c" class="cell code"
data-execution_count="43">
<div class="sourceCode" id="cb30"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification Report - Training </span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_train, y_pred_train))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification Report - Testing </span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred_test))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>              precision    recall  f1-score   support

           0       0.90      0.96      0.93      3744
           1       0.74      0.50      0.60       760

    accuracy                           0.89      4504
   macro avg       0.82      0.73      0.77      4504
weighted avg       0.88      0.89      0.88      4504



              precision    recall  f1-score   support

           0       0.91      0.96      0.93       938
           1       0.73      0.50      0.59       188

    accuracy                           0.89      1126
   macro avg       0.82      0.73      0.76      1126
weighted avg       0.88      0.89      0.88      1126

</code></pre>
</div>
</div>
<div id="f9a86bc2-3a8d-496b-b840-be26ca91bf89" class="cell code"
data-execution_count="44">
<div class="sourceCode" id="cb32"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>sns.heatmap(confusion_matrix(y_test, y_pred_test), annot <span class="op">=</span> <span class="va">True</span>, fmt <span class="op">=</span> <span class="st">&quot;.5g&quot;</span>, cmap <span class="op">=</span> <span class="st">&quot;Blues&quot;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="44">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_baed5312ae0c402f83c657da0b4c49fd/5c27f873b941bfb210024cfa5c8c6869652f944d.png" /></p>
</div>
</div>
<div id="30900535-3764-4c7b-b8c9-3960058e0613" class="cell markdown">
<p><strong>Decision Tree</strong></p>
</div>
<div id="8fdd10b2-ed9f-4dd6-a69c-cfd0bc7fa0bd" class="cell code"
data-execution_count="45">
<div class="sourceCode" id="cb34"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> DecisionTreeClassifier(random_state <span class="op">=</span> <span class="dv">123</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>dt.fit(x_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="45">
<style>#sk-container-id-5 {color: black;}#sk-container-id-5 pre{padding: 0;}#sk-container-id-5 div.sk-toggleable {background-color: white;}#sk-container-id-5 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-5 label.sk-toggleable__label-arrow:before {content: "";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-5 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-5 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-5 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-5 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-5 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-5 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "";}#sk-container-id-5 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-5 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-5 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-5 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-5 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-5 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-5 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-5 div.sk-item {position: relative;z-index: 1;}#sk-container-id-5 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-5 div.sk-item::before, #sk-container-id-5 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-5 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-5 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-5 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-5 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-5 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-5 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-5 div.sk-label-container {text-align: center;}#sk-container-id-5 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-5 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-5" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>DecisionTreeClassifier(random_state=123)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-5" type="checkbox" checked><label for="sk-estimator-id-5" class="sk-toggleable__label sk-toggleable__label-arrow">DecisionTreeClassifier</label><div class="sk-toggleable__content"><pre>DecisionTreeClassifier(random_state=123)</pre></div></div></div></div></div>
</div>
</div>
<div id="d5788b24-7672-43f6-9dd7-a11ee35e8baf" class="cell code"
data-execution_count="46">
<div class="sourceCode" id="cb35"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>y_pred_train <span class="op">=</span> dt.predict(x_train)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>y_pred_test <span class="op">=</span> dt.predict(x_test)</span></code></pre></div>
</div>
<div id="3fe91ad3-34a0-4d7e-b04a-c0458121830a" class="cell code"
data-execution_count="47" data-scrolled="true">
<div class="sourceCode" id="cb36"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification Report - Training </span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_train, y_pred_train))</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification Report - Testing </span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred_test))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>              precision    recall  f1-score   support

           0       1.00      1.00      1.00      3744
           1       1.00      1.00      1.00       760

    accuracy                           1.00      4504
   macro avg       1.00      1.00      1.00      4504
weighted avg       1.00      1.00      1.00      4504



              precision    recall  f1-score   support

           0       0.97      0.97      0.97       938
           1       0.86      0.86      0.86       188

    accuracy                           0.95      1126
   macro avg       0.91      0.92      0.92      1126
weighted avg       0.95      0.95      0.95      1126

</code></pre>
</div>
</div>
<div id="12dd9540-aa68-4d7f-abeb-a12113f484f6" class="cell code"
data-execution_count="48">
<div class="sourceCode" id="cb38"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>sns.heatmap(confusion_matrix(y_test, y_pred_test), annot <span class="op">=</span> <span class="va">True</span>, fmt <span class="op">=</span> <span class="st">&quot;.5g&quot;</span>, cmap <span class="op">=</span> <span class="st">&quot;Blues&quot;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="48">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_baed5312ae0c402f83c657da0b4c49fd/70062129768196ba2c4ee0e07316a83084074dac.png" /></p>
</div>
</div>
<div id="d2efb8ee-1eb3-4ac6-981b-502f3fb71e8d" class="cell markdown">
<p><strong>Random Forest</strong></p>
</div>
<div id="864f307e-64be-446f-9341-a8d250961e3a" class="cell code"
data-execution_count="57">
<div class="sourceCode" id="cb40"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>rf <span class="op">=</span> RandomForestClassifier(n_estimators <span class="op">=</span> <span class="dv">50</span>, random_state <span class="op">=</span> <span class="dv">123</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>rf.fit(x_train, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="57">
<style>#sk-container-id-8 {color: black;}#sk-container-id-8 pre{padding: 0;}#sk-container-id-8 div.sk-toggleable {background-color: white;}#sk-container-id-8 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-8 label.sk-toggleable__label-arrow:before {content: "";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-8 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-8 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-8 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-8 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-8 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-8 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "";}#sk-container-id-8 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-8 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-8 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-8 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-8 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-8 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-8 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-8 div.sk-item {position: relative;z-index: 1;}#sk-container-id-8 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-8 div.sk-item::before, #sk-container-id-8 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-8 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-8 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-8 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-8 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-8 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-8 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-8 div.sk-label-container {text-align: center;}#sk-container-id-8 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-8 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-8" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>RandomForestClassifier(n_estimators=50, random_state=123)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-8" type="checkbox" checked><label for="sk-estimator-id-8" class="sk-toggleable__label sk-toggleable__label-arrow">RandomForestClassifier</label><div class="sk-toggleable__content"><pre>RandomForestClassifier(n_estimators=50, random_state=123)</pre></div></div></div></div></div>
</div>
</div>
<div id="5d7c8137-fae4-4eee-bc12-51af47452da8" class="cell code"
data-execution_count="58">
<div class="sourceCode" id="cb41"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>y_pred_train <span class="op">=</span> rf.predict(x_train)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>y_pred_test <span class="op">=</span> rf.predict(x_test)</span></code></pre></div>
</div>
<div id="30dcf662-c8af-448a-998f-e536b5a7f294" class="cell code"
data-execution_count="59">
<div class="sourceCode" id="cb42"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification Report - Training </span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_train, y_pred_train))</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>()</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Classification Report - Testing </span></span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(classification_report(y_test, y_pred_test))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>              precision    recall  f1-score   support

           0       1.00      1.00      1.00      3744
           1       1.00      1.00      1.00       760

    accuracy                           1.00      4504
   macro avg       1.00      1.00      1.00      4504
weighted avg       1.00      1.00      1.00      4504



              precision    recall  f1-score   support

           0       0.96      1.00      0.98       938
           1       0.97      0.81      0.89       188

    accuracy                           0.97      1126
   macro avg       0.97      0.90      0.93      1126
weighted avg       0.97      0.97      0.96      1126

</code></pre>
</div>
</div>
<div id="1b3b8134-b742-436e-bbfb-59cd2a5a515b" class="cell code"
data-execution_count="61">
<div class="sourceCode" id="cb44"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>sns.heatmap(confusion_matrix(y_test, y_pred_test), annot <span class="op">=</span> <span class="va">True</span>, fmt <span class="op">=</span> <span class="st">&quot;.5g&quot;</span>, cmap <span class="op">=</span> <span class="st">&quot;Blues&quot;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="61">
<pre><code>&lt;Axes: &gt;</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_baed5312ae0c402f83c657da0b4c49fd/d48704325dda8913354834751f3a7a2941650ee6.png" /></p>
</div>
</div>
<div id="e4f8c38b-3554-47d3-ad59-71d652d7ef4f" class="cell markdown">
<ul>
<li>Logistic model is undefitting while Decision tree is
overfitting.</li>
<li>Random Forest has a better metric score compared to other
models.</li>
</ul>
</div>
<div id="153ced88-2390-4786-a025-214761c57406" class="cell code"
data-execution_count="62">
<div class="sourceCode" id="cb46"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predicting the whole dataset using the model</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>Y_pred <span class="op">=</span> rf.predict(X)</span></code></pre></div>
</div>
<div id="f4cd0b7a-b7e1-4d87-a48b-a7dc836f9f7d" class="cell code"
data-execution_count="63">
<div class="sourceCode" id="cb47"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Creating a dataset with customers corresponding to the predictions</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>new_df <span class="op">=</span> pd.concat((ecom[<span class="st">&#39;CustomerID&#39;</span>], pd.Series(Y_pred)), axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>new_df.columns <span class="op">=</span> [<span class="st">&quot;CustomerID&quot;</span>, <span class="st">&quot;Churn&quot;</span>]</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>new_df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="63">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerID</th>
      <th>Churn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>50001</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50002</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>50003</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>50004</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>50005</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div id="93bcac2c-4aff-4ad4-9bd7-bb3aa28c9274" class="cell code"
data-execution_count="64">
<div class="sourceCode" id="cb48"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>new_df[new_df[<span class="st">&#39;Churn&#39;</span>] <span class="op">==</span> <span class="dv">1</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="64">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CustomerID</th>
      <th>Churn</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>50001</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>50002</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>50003</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>50004</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>50005</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5556</th>
      <td>55557</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5598</th>
      <td>55599</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5602</th>
      <td>55603</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5604</th>
      <td>55605</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5612</th>
      <td>55613</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>917 rows  2 columns</p>
</div>
</div>
</div>
<div id="76b4fd56-8258-43f9-b9c0-4a11c13737e7" class="cell markdown">
<ul>
<li>Based on the model 917 customers from the whole dataset with the
given corresponding ID's are likely to Churn in the future.</li>
</ul>
</div>
<div id="397ec284-1f7f-4e55-8f83-3177570b7429" class="cell markdown">
<h3 id="marketing-strategy">Marketing Strategy</h3>
<ul>
<li><strong>During our analysis we found that most customers are leaving
at the first few months of the service tenure. These customers churned
maybe because they found a better alternative to what the company was
already offering. A better understanding of the competitora as well as
providing attractive offers to new customers can be a way to improve
retention.</strong></li>
<li><strong>Actively seeking feedback from customers who leave early as
well as concentrating on providing flexible plans to cities where the
customer satisfaction scores are low can be also implemented to reduce
churn.</strong></li>
<li><strong>Implementing regular follow-up to customers who recently
joined can improve their perspective of the company as well as motivate
them to refer others.</strong></li>
</ul>
</div>
</body>
</html>
